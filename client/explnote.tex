\documentclass[explnote]{espd}
\usepackage[russian]{babel}
\usepackage{amsmath}

\bibliographystyle{gost2008}

\managerrank{Научный руководитель,\\доцент департамента\\программной инженерии\\факультета компьютерных наук,\\канд. техн. наук}
\manager{С.Л. Макаров}

\authorrank{студент группы БПИ183}
\author{М.И. Сердюков}

\title{Мессенджер с поиском по Bluetooth\\(клиентская часть)}
\code{02.07}

\city{Москва}
\year{2021}

\begin{document}

\annotation
Пояснительная записка -- это документ, в котором описаны используемые алгоритмы, принципы функционирования и другая информация, касающаяся работы программы.

Настоящая Пояснительная записка содержит следующие разделы: <<Введение>>, <<Назначение и область применения>>, <<Технические характеристики>>, <<Ожидаемые технико-экономические показатели>>.

В разделе <<Введение>> указано наименование программы и приведены основания для разработки.

В разделе <<Назначение и область применения>> приведено назначение программы и описана характеристика области ее применения.

В разделе <<Технические характеристики>> указана постановка задачи на разработку, используемые в программе алгоритмы, принципы функционирования и методы организации входных и выходных данных.

В разделе <<Ожидаемые технико-экономические показатели>> указана предполагаемая потребность и преимущества разработки над аналогами.

Настоящая Пояснительная записка удовлетворяет требованиям ГОСТ 19.404-79~\cite{espd404}.

\tableofcontents

\section{Введение}
\subsection{Наименование программы}
\paragraph{Наименование программы на русском языке}
Мессенджер с поиском по Bluetooth.
\paragraph{Наименование программы на английском языке}
Messenger with Bluetooth Search.

\subsection{Условное обозначение разработки}
Условное обозначение разработки -- <<closecom>>.

\subsection{Основание для разработки}
Основанием для разработки является учебный план подготовки бакалавров по направлению 09.03.04 <<Программная инженерия>> и утвержденная академическим руководителем тема курсового проекта.

\section{Назначение и область применения}
\subsection{Область применения программы}
Программа представляет собой мобильное приложения для передачи сообщений в виде текста и файлов, с возможностью поиска пользователей по блютуз.

Для полного функционирования необходимо взаимодействие с серверным приложением.

\subsection{Назначение разработки}
\paragraph{Функциональное назначение программы}
Мобильное приложение решает задачу мессенджера - обладает функциями для авторизации пользователя, отправки и получения сообщений.

\paragraph{Эксплуатационное назначение программы}
Программа предназначена для людей, которые используют свои мобильные устройства для общения, по средствам отправки текстовых сообщений.

\section{Требования к программе}
\subsection{Требования к функциональным характеристикам}

Программа (мобильное приложение) должна обеспечивать следующий функционал:

\begin{enumerate}
\item Авторизация в приложении через электронную почту и пароль (создание аккаунта, регистрация);
\item Поиск пользователей в приложении по его идентификатору;
\item Возможность написать сообщение другому пользователю приложения (в виде текста и файлов);
\item Возможность просмотра истории сообщений с другим пользователем (чат с пользователем);
\item Возможность удаления чата с другим пользователем;
\item Начать переписку с другим пользователем "поблизости", используя Bluetooth;
\item Изменить электронную почту и пароль, привязанные к аккаунту;
\item Пользователь должен иметь возможность удалить собственный аккаунт.
\end{enumerate}

\paragraph{Требования к интерфейсу}

Мобильное приложение должно иметь следующую структуру интерфейса:

\begin{enumerate}
\item Экран авторизации;
\item Экран со списком всех доступных чатов;
\item Меню с настройками аккаунта и приложения;
\item Список всех сообщений с конкретным пользователем (экран чата);
\item Экран поиска пользователей по идентификатору;
\item Экран пользователей "поблизости", для поиска с использованием Bluetooth.
\end{enumerate}

\section{Технические характеристики}
\subsection{Постановка задачи на разработку программы}
Разрабатываемое мобильное приложение должно обеспечивать выполнения заявленной в требованиях функциональности. А также реализовать поддержку серверной части проекта с использованием REST Api клиента. 

\subsection{Описание используеумых алгоритмов}
\paragraph{Механизм сканирования пользователей по bluetooth}
Поиск пользователей по близости осуществляется с использованием технологии bluetooth. После захода в приложение, bluetooth адрес пользователя сохраняется на удаленном сервере, при помощи POST запроса.

Затем, при сканировании, осуществляется bluetooth устройств по близости. Каждый адрес найденного устройства сравнивается с тем, который сохранил сервер на предыдущем шаге. Если совпадение было найдено, осуществляется получение данных этого пользователся (его имя и email).

\begin{verbatim}
override fun startScan() {
    scanner.startScan(object : ScanCallback() {
        override fun onScanResult(callbackType: Int, result: ScanResult) {

            val mac = result.device.address
            if (devices.find { it == mac } == null) {
                devices.add(mac)
                addDevicesToList(mac)
            }
        }
    })
}
\end{verbatim}

На листинге приведен пример кода, осуществляющего поиск адресов пользователей по близости, при помощи использования BluetoothLeScanner, класса из стандартной библиотеки Android. После того как пользователь был обнаружен, он будет добавлен в список найденных пользователей при помощи addDevicesToList(mac).

\paragraph{Обновление списка чатов и сообщений}
Для обеспеченья динамичности интерфейса, что бы данные менялись автоматическии, без взаимодействия пользователя, был использован паттерн Polling~\cite{polling}.

Для обновления спииска чатов REST Api~\cite{rest} клиент совершает запрос к серверу с интервалом 3 секунды.

\paragraph{Навигация в приложении}
Для обеспеченья навигации в приложении использовался подход Single Activity Application~\cite{SAA}. Он заключается в том, что на все приложение создается единственный тип Activity. Каждый экран представляет собой определенный тип Fragment. Activity сама определяет какой фрагмент должен быть показан в данный момент, в зависимости от ползьзовательских действий. 

Таким образом обеспечивается <<легковесность>> программы и высокая отзывчивость интерфейса.

\paragraph{Хранение пользовательских данных}
Для того, что бы обеспечить сохранение данных пользователя между сессиями использования приложения используется локальное хранилище.

Таким образом, при перезаходе в приложение пользователю не приходится заново авторизироваться, это происходит автоматически. 

\subsection{Описание и обоснование выбора метода организации входных и выходных данных}
\paragraph{Организация входных данных}
Выходные данные для программы -- это системные события, результаты сканирования блютуз устройств по близости, ui события вызываемые пользователем, а так же данные, поступающие с удаленного сервера.

\paragraph{Организация выходных данных}\label{paragraph:output}
Выходные данные программы:

\begin{enumerate}
\item HTTP-запросы к удаленному серверу;
\item события логирования;
\item текстовые сообщения, посылаемые другим пользователям.
\end{enumerate}

\subsection{Описание и обоснование выбора состава технических средств}
Для работы программы необходимо мобильное устройство на платформе Android (смартфон). Минимальные системные требования:

\begin{enumerate}
\item Оперативная память объемом 1 Гб;
\item Размер внутренней памяти 500 Мб;
\item Наличие Bluetooth модуля;
\item Наличие подключения к сети интернет;
\end{enumerate}

\subsection{Описание и обоснование выбора программных средств}
Для осуществления запросов к серверу используется стандартный механиз HttpURLConnection~\cite{httpUrl}. Он обеспечивает все необходимые функции для реализации REST Api клиента.

В качестве механизма подписок и работы с многопоточностью использовалась библиотека JavaRx3. Она показывается высокую эффективность благодаря механизму троттлинга событий, возникающих в системе слишком часто. 

\bibliography{espd,library}

\end{document}

